# makeversion.in for M root directory
# provides version and patchlevel information
# $Id$

M_VERSION_MAJOR=0
M_VERSION_MINOR=65
M_RELEASE=0		# 0 for prerelease, 1 for release, 2 for stable
M_PATCHLEVEL=0
M_STRING='Claire'

case "$M_RELEASE.$M_PATCHLEVEL" in
0.0)	M_STATUS=a	;;
0.1)	M_STATUS=b	;;
0.2)	M_STATUS=c	;;
0.3)	M_STATUS=d	;;
0.4)	M_STATUS=e	;;
0.5)	M_STATUS=f	;;
0.6)	M_STATUS=g	;;
0.7)	M_STATUS=h	;;
*)	M_STATUS=''	;;
esac

rm -f makeversion
cat <<EOF >makeversion
# DO NOT EDIT - generated file
# Mahogany version/release/patchlevel
M_VERSION_MAJOR	:= $M_VERSION_MAJOR
M_VERSION_MINOR	:= $M_VERSION_MINOR
M_RELEASE	:= $M_RELEASE
M_PATCHLEVEL	:= $M_PATCHLEVEL
M_STATUS	:= '$M_STATUS'
EOF

rm -f conftmp
cat <<EOF >conftmp
// DO NOT EDIT - generated file
// //// //// //// //// //// //// //// //// //// //// //// //// //// //// //////
// Project:	Mahogany
// File name:	Mversion.h - contains the M version and patchlevel
// Purpose:	provide version and patchlevel information
// Created:	automatically generated by makeversion.in
// Copyright:	(c) 1998 Vadim Zeitlin <zeitlin@dptmaths.ens-cachan.fr>
// Licence:	M license
// //// //// //// //// //// //// //// //// //// //// //// //// //// //// //////

#ifndef _M_VERSION_H
#define _M_VERSION_H

// ----------------------------------------------------------------------------
// version info constants
// ----------------------------------------------------------------------------

/// version info
#define M_VERSION_MAJOR		$M_VERSION_MAJOR
#define M_VERSION_MINOR		$M_VERSION_MINOR
#define M_VERSION_RELEASE	$M_RELEASE
#define M_PATCHLEVEL		$M_PATCHLEVEL
#define M_VERSION_STATUS	"$M_STATUS" // "a"=alpha

/// short version string (it should always have this format!)
#define M_VERSION		"$M_VERSION_MAJOR.$M_VERSION_MINOR"

/// full version string
#define M_VERSION_STRING	"$M_VERSION_MAJOR.$M_VERSION_MINOR '$M_STRING'"

#endif //_M_VERSION_H
EOF
if cmp -s conftmp include/Mversion.h
then	rm -f conftmp
else	mv conftmp include/Mversion.h
fi
exit
